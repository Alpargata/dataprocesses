library(ggplot2)
library(dplyr)
co2data<-read.csv(
"../data/co2.csv",
header=TRUE, na.strings = TRUE , as.is = TRUE)
summary(co2data)
head(co2data)
# Data Preprocessing
# Data Cleaning
co2data$Date = substr(co2data$Date, start = 0, stop = 4)
co2data$Date = factor(co2data$Date)
co2data <- subset( co2data, select = -Decimal.Date ) #Removing the Decimal.Date since we already have a Date coloum and it is redoundant
#rename coloumns for a better interpretation
outlier_values <- boxplot.stats(co2data$Trend)$out  # detecting outliers values
#remove the outliers as there are only 7 values with -99.99 (that represents Missing months are denoted by -99.99)
co2data <- co2data %>%
rename(
Days = Number.of.Days
)%>%
filter(Average != '-99.99')
#question n 2: What was (in terms of climate change) the 'worst year' for our planet? (more polluted year, higher temperature...)
#By worst year here we mean that we are looking for the highest CO2 level in the data
#pre-testing assumption: we expect that the woorst year will be towards the end as it is constatly increasing
plot(co2data$Date, y = co2data$Trend)
#grouping by year
co2data<-  co2data %>%
group_by(Date) %>%
summarise(Trend = median(Trend))
summary(co2data)
plot(co2data$Date, y = co2data$Trend)
worst_year <-co2data %>%
filter(Trend == max(Trend))  %>%
select(Date)
#question n 2: What was (in terms of climate change) the 'worst year' for our planet? (more polluted year, higher temperature...)
#By worst year here we mean that we are looking for the highest CO2 level in the data
#pre-testing assumption: we expect that the woorst year will be towards the end as it is constatly increasing
plot(co2data$Date, y = co2data$Trend)
library(ggplot2)
library(dplyr)
library(car)
library(FactoMineR)
data<-read.csv(
"https://raw.githubusercontent.com/Alpargata/dataprocesses/master/data/seaice.csv",
header=TRUE)
summary(data)
head(data)
df <- subset( data, select = -Source.Data ) #We remove the link provided, since its
#not useful for our purpose at least in first place
df$Date=as.Date(paste(sep="-",df$Year,df$Month,df$Day)) # we aggregate the date to easen the
#manipulation
ag<-aggregate(df['Extent'], by=df['Date'], sum)
names(ag)[names(ag)=="Extent"]<-"Global Extent"
rs<-aggregate(x = df["Extent"], by=df["Date"],
FUN = function(a){
y<-a[1]-a[2];
})
names(rs)[names(rs)=="Extent"]<-"North-South Difference"
df <- merge(df,ag,by="Date")
df <- merge(df,rs,by="Date")
north = df[df$hemisphere == "north",]
south = df[df$hemisphere == "south",]
lm1 = lm(data=df, Extent~ . )
summary(lm1)
anova(lm1)
ggplot(data=df,aes(x = Date, y = Extent, color=hemisphere))+
geom_point()
ggplot(data=north,aes(x = Date, y = Extent, color=hemisphere))+
geom_point()+
geom_smooth(method='lm', formula= y~x)
ggplot(data=df,aes(x = Date, y = Extent, color=hemisphere))+
geom_point()
ggplot(data=north,aes(x = Date, y = Extent, color=hemisphere))+
geom_point()+
geom_smooth(method='lm', formula= y~x)
ggplot(data=south,aes(x = Date, y = Extent, color=hemisphere))+
geom_point()+
geom_smooth(method='lm', formula= y~x)
ggplot(data=north,aes(x = Date, y = Extent, color=hemisphere))+
geom_point()+
geom_smooth(method='lm', formula= y~x)
ggplot(data=south,aes(x = Date, y = Extent, color=hemisphere))+
geom_point()+
geom_smooth(method='lm', formula= y~x)
library(ggplot2)
library(dplyr)
co2data<-read.csv("../data/co2.csv",header=TRUE, na.strings = TRUE , as.is = TRUE)
co2_data<-read.csv("../data/co2.csv",header=TRUE, na.strings = TRUE , as.is = TRUE)
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
View(co2_data)
View(ice_data)
View(co2_data)
View(co2_data)
co2_data <- co2_data %>% select(-Decimal.Date)
View(co2_data)
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
View(ice_data)
ice_data<-ice_data %>% select(-Source.Data)
View(ice_data)
View(co2_data)
View(ice_data)
ice_data<-filter(Missing==0)
ice_data<-ice_data %>% filter(Missing==0)
co2_data<-read.csv("../data/co2.csv",header=TRUE, na.strings = TRUE , as.is = TRUE)
co2_data <- co2_data %>% select(-Decimal.Date)
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
ice_data<-ice_data %>% select(-Source.Data)
View(co2_data)
View(ice_data)
ice_data %>% filter(Missing==0)
ice_data %>% filter(Missing!=0)
library(ggplot2)
library(dplyr)
co2_data<-read.csv("../data/co2.csv",header=TRUE, na.strings = TRUE , as.is = TRUE)
co2_data <- co2_data %>% select(-Decimal.Date) %>% select(-Number.of.Days)
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
ice_data<-ice_data %>% select(-Source.Data) %>% select (-Missing) %>% select (-Day)
ice_data<-ice_data %>% group_by(Year, Month) %>% summarise(Extent=mean(Extent)) %>% arrange(Year, Month)
ice_data %>% mutate(Date=paste(c(Year,'-',Month,'-01'), collapse=''))
paste(ice_data$Year, "-", ice_data$Month)
paste(ice_data$Year, "-", ice_data$Month, collapse='')
paste(ice_data$Year, "-", ice_data$Month)
paste0(ice_data$Year, "-", ice_data$Month)
paste0(ice_data$Year, "-", ice_data$Month,'-01')
ice_data<- mutate(ice_data, Date=paste0(ice_data$Year, "-", ice_data$Month,'-01'))
ice_data<- mutate(ice_data, Date=paste0(ice_data$Year, "-", ice_data$Month,'-01'))
ice_data$Date<-paste0(ice_data$Year, "-", ice_data$Month,'-01')
View(ice_data)
ice_data$Date<-as.Date(paste0(ice_data$Year, "-", ice_data$Month,'-01'))
View(co2_data)
ice_data$Date<-as.Date(paste0(ice_data$Year, "-", ice_data$Month,'-01'), format = "%Y-%m-%d")
View(ice_data)
library(ggplot2)
library(dplyr)
co2_data<-read.csv("../data/co2.csv",header=TRUE, na.strings = TRUE , as.is = TRUE)
co2_data <- co2_data %>% select(-Decimal.Date) %>% select(-Number.of.Days)
co2_data<-as.Date(Date, format = "%Y-%m-%d")
co2_data<-as.Date(co2_data$Date, format = "%Y-%m-%d")
View(co2_data)
co2_data<-read.csv("../data/co2.csv",header=TRUE, na.strings = TRUE , as.is = TRUE)
co2_data <- co2_data %>% select(-Decimal.Date) %>% select(-Number.of.Days)
co2_data$Date<-as.Date(co2_data$Date, format = "%Y-%m-%d")
View(co2_data)
ice_data<-ice_data %>% select(-Year) %>% select(-Month)
View(ice_data)
co2_data<-read.csv("../data/co2.csv",header=TRUE, na.strings = TRUE , as.is = TRUE)
co2_data <- co2_data %>% select(-Decimal.Date) %>% select(-Number.of.Days)
co2_data$Date<-as.Date(co2_data$Date, format = "%Y-%m-%d")
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
ice_data<-ice_data %>% select(-Source.Data) %>% select (-Missing) %>% select (-Day)
ice_data<-ice_data %>% group_by(Year, Month) %>% summarise(Extent=mean(Extent)) %>% arrange(Year, Month)
ice_data$Date<-as.Date(paste0(ice_data$Year, "-", ice_data$Month,'-01'), format = "%Y-%m-%d")
ice_data<-ice_data %>% select(-Year) %>% select(-Month)
View(co2_data)
library(ggplot2)
ice_data<-ice_data %>% select(-Year) %>% select(-Month)
co2_data<-read.csv("../data/co2.csv",header=TRUE, na.strings = TRUE , as.is = TRUE)
co2_data <- co2_data %>% select(-Decimal.Date) %>% select(-Number.of.Days)
co2_data$Date<-as.Date(co2_data$Date, format = "%Y-%m-%d")
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
ice_data<-ice_data %>% select(-Source.Data) %>% select (-Missing) %>% select (-Day)
ice_data<-ice_data %>% group_by(Year, Month) %>% summarise(Extent=mean(Extent)) %>% arrange(Year, Month)
ice_data$Date<-as.Date(paste0(ice_data$Year, "-", ice_data$Month,'-01'), format = "%Y-%m-%d")
View(ice_data)
ice_data<-ice_data %>% group_by(Year, Month) %>% summarise(Extent=mean(Extent)) %>% arrange(Year, Month)
ice_data$Date<-as.Date(paste0(ice_data$Year, "-", ice_data$Month,'-01'), format = "%Y-%m-%d")
ice_data<-ice_data %>% select(-Year) %>% select(-Month)
View(ice_data)
#ice_data %>% mutate(Date=paste(c(Year,'-',Month,'-01'), collapse=''))
joined_df<-inner_join(ice_data, co2_data, by='Date')
View(joined_df)
ice_data<-ice_data %>% select(-Year) %>% select(-Month)
plot(co2_data$Date, co2_data$Interpolated)
plot(co2_data$Date, co2_data$Average)
plot(co2_data$Date, co2_data$Trend)
range(0,1000)
seq(0,100)
#ice_data %>% mutate(Date=paste(c(Year,'-',Month,'-01'), collapse=''))
joined_df<-inner_join(ice_data, co2_data, by='Date') %>%
joined_df <- mutate(Counter, seq(0,nrow(joined_df)))
#ice_data %>% mutate(Date=paste(c(Year,'-',Month,'-01'), collapse=''))
joined_df<-inner_join(ice_data, co2_data, by='Date') %>%
joined_df <- joined_df %>%  mutate(Counter, seq(0,nrow(joined_df)))
#ice_data %>% mutate(Date=paste(c(Year,'-',Month,'-01'), collapse=''))
joined_df<-inner_join(ice_data, co2_data, by='Date') %>%
joined_df <- joined_df %>%  mutate(Counter, Counter=seq(0,nrow(joined_df)))
#ice_data %>% mutate(Date=paste(c(Year,'-',Month,'-01'), collapse=''))
joined_df<-inner_join(ice_data, co2_data, by='Date') %>%
joined_df <- joined_df %>%  mutate(Counter=seq(0,nrow(joined_df)))
seq(0,nrow(joined_df)
)
#ice_data %>% mutate(Date=paste(c(Year,'-',Month,'-01'), collapse=''))
joined_df<-inner_join(ice_data, co2_data, by='Date') %>%
joined_df <- joined_df %>%  mutate(Counter=seq(0,nrow(joined_df)-1))
#ice_data %>% mutate(Date=paste(c(Year,'-',Month,'-01'), collapse=''))
joined_df<-inner_join(ice_data, co2_data, by='Date') %>%
joined_df$Counter <- seq(0,nrow(joined_df)-1)
joined_df$Counter <- seq(0,nrow(joined_df)-1)
View(joined_df)
joined_df$Counter <- seq(1,nrow(joined_df))
View(joined_df)
typeof(joined_df)
typeof(ice_data)
typeof(co2_data)
model1<-glm(Extent ~ Trend + Counter,data = joined_df)
summary(model1)
model1<-lm(Extent ~ Trend + Counter,data = joined_df)
summary(model1)
model1<-lm(Extent ~ Trend + Counter,data = joined_df)
model2<-glm(Extent ~ Trend + Counter,data = joined_df)
summary(model1)
summary(model2)
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
ice_data<-ice_data %>% select(-Source.Data) %>% select (-Missing) %>% select (-Day)
ice_data<-ice_data %>% group_by(Year, Month) %>% summarise(Extent=mean(Extent)) %>% arrange(Year, Month)
ice_data$Date<-as.Date(paste0(ice_data$Year, "-", ice_data$Month,'-01'), format = "%Y-%m-%d")
joined_df<-inner_join(ice_data, co2_data, by='Date')
joined_df$Counter <- seq(1,nrow(joined_df))
model1<-lm(Extent ~ Trend + Counter + Year + Month, data = joined_df)
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
ice_data<-ice_data %>% select(-Source.Data) %>% select (-Missing) %>% select (-Day)
ice_data<-ice_data %>% group_by(Year, Month) %>% summarise(Extent=mean(Extent)) %>% arrange(Year, Month)
ice_data$Date<-as.Date(paste0(ice_data$Year, "-", ice_data$Month,'-01'), format = "%Y-%m-%d")
joined_df<-inner_join(ice_data, co2_data, by='Date')
joined_df$Counter <- seq(1,nrow(joined_df))
co2_data<-read.csv("../data/co2.csv",header=TRUE, na.strings = TRUE , as.is = TRUE)
co2_data <- co2_data %>% select(-Decimal.Date) %>% select(-Number.of.Days)
co2_data$Date<-as.Date(co2_data$Date, format = "%Y-%m-%d")
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
ice_data<-ice_data %>% select(-Source.Data) %>% select (-Missing) %>% select (-Day)
ice_data<-ice_data %>% group_by(Year, Month) %>% summarise(Extent=mean(Extent)) %>% arrange(Year, Month)
ice_data$Date<-as.Date(paste0(ice_data$Year, "-", ice_data$Month,'-01'), format = "%Y-%m-%d")
joined_df<-inner_join(ice_data, co2_data, by='Date')
joined_df$Counter <- seq(1,nrow(joined_df))
View(co2_data)
View(ice_data)
model1<-lm(Extent ~ Trend + Counter + Year + Month, data = joined_df)
model2<-glm(Extent ~ Trend + Counter + Year + Month, data = joined_df)
summary(model1)
summary(model2)
joined_df<-inner_join(ice_data, co2_data, by='Date')
model1<-lm(Extent ~ Trend + Counter + Year + Month, data = joined_df)
model1<-lm(Extent ~ Trend + Year + Month, data = joined_df)
model2<-glm(Extent ~ Trend + Year + Month, data = joined_df)
summary(model1)
summary(model2)
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
ice_data<-ice_data %>% select(-Source.Data) %>% select (-Missing) %>% select (-Day)
View(ice_data)
ice_data<-ice_data %>% group_by(Year, Month) %>% summarise(Extent=mean(Extent)) %>% arrange(Year, Month)
ice_data$Date<-as.Date(paste0(ice_data$Year, "-", ice_data$Month,'-01'), format = "%Y-%m-%d")
View(ice_data)
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
ice_data<-ice_data %>% select(-Source.Data) %>% select (-Missing) %>% select (-Day)
ice_data<-ice_data %>% group_by(Year, Month, hemisphere) %>% summarise(Extent=mean(Extent)) %>% arrange(Year, Month)
ice_data$Date<-as.Date(paste0(ice_data$Year, "-", ice_data$Month,'-01'), format = "%Y-%m-%d")
joined_df<-inner_join(ice_data, co2_data, by='Date')
View(joined_df)
model1<-lm(Extent ~ Trend + Year + Month + hemisphere, data = joined_df)
model2<-glm(Extent ~ Trend + Year + Month + hemisphere, data = joined_df)
summary(model1)
summary(model2)
model2<-glm(Extent ~ Trend + Year + Month, data = joined_df)
model1<-lm(Extent ~ Trend + Year + Month, data = joined_df)
model2<-glm(Extent ~ Trend + Year + Month, data = joined_df)
summary(model1)
summary(model2)
ice_data<-read.csv("../data/seaice.csv",header=TRUE)
ice_data<-ice_data %>% select(-Source.Data) %>% select (-Missing) %>% select (-Day)
ice_data<-ice_data %>% group_by(Year, Month) %>% summarise(Extent=mean(Extent)) %>% arrange(Year, Month)
ice_data$Date<-as.Date(paste0(ice_data$Year, "-", ice_data$Month,'-01'), format = "%Y-%m-%d")
joined_df<-inner_join(ice_data, co2_data, by='Date')
model1<-lm(Extent ~ Trend + Year + Month, data = joined_df)
model2<-glm(Extent ~ Trend + Year + Month, data = joined_df)
summary(model1)
summary(model2)
model3<-knn(Extent ~ Trend + Year + Month, train=joined_df, test=joined_df)
library(DMwR)
install.packages("DMwR")
library(DMwR)
model3<-knn(Extent ~ Trend + Year + Month, train=joined_df, test=joined_df)
?createDataPartition
??createDataPartition
##load the package class
library(class)
?knn
?knn.reg
?knnreg
library(Caret)
library(caret)
##load the package class
library(class)
?knn
library(reg)
library(caret)
?train
modeling_df<-joined_df %>% select(-Date) %>% select(-Average) %>% select(-Interpolated)
View(modeling_df)
library(caret)
modeling_df<-joined_df %>% select(-Date) %>% select(-Average) %>% select(-Interpolated)
trainIndex <- createDataPartition(modeling_df$Extent,
p = .8,       # Proportion of data used for training
list = FALSE, # Return the values as a vector (as opposed to a list)
times = 1     # Only create one set of training indices
)
# Subset your data into training and testing set
training_set <- modeling_df[ trainIndex, ] # Select rows with generated indices
test_set <- modeling_df[ -trainIndex, ]    # Remove rows with generated indices
linear_model<-lm(Extent ~ Trend + Year + Month, data = joined_df)
View(training_set)
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set, method = "knn")
plot(knn_model)
# Make predictions on the test data
predictions <- knn_model %>% predict(test_set)
head(predictions)
# Compute the prediction error RMSE
RMSE(predictions, test_set$Extent)
summary(knn_model)
plot(knn_model)
View(training_set)
modeling_df<-joined_df %>% select(-Date) %>% select(-Average) %>% select(-Interpolated)
trainIndex <- createDataPartition(modeling_df$Extent,
p = .8,       # Proportion of data used for training
list = FALSE, # Return the values as a vector (as opposed to a list)
times = 1     # Only create one set of training indices
)
# Subset your data into training and testing set
training_set <- modeling_df[ trainIndex, ] # Select rows with generated indices
View(training_set)
test_set <- modeling_df[ -trainIndex, ]    # Remove rows with generated indices
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set, method = "knn")
plot(knn_model)
# Make predictions on the test data
predictions <- knn_model %>% predict(test_set)
head(predictions)
# Compute the prediction error RMSE
RMSE(predictions, test_set$Extent)
# Compute the prediction error RMSE
RMSE(predictions, test_set$Extent)
RMSE(predict(knn_model, test_set), test_set$Extent)
RMSE(predict(knn_model, test_set), training_set$Extent)
# Make predictions on the test data
predictions <- knn_model %>% predict(test_set)
head(predictions)
# Compute the prediction error RMSE
RMSE(predict(knn_model, training_set), training_set$Extent)
RMSE(predict(knn_model, test_set), test_set$Extent)
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set, method = "rf")
?train
# Compute the prediction error RMSE
RMSE(predict(knn_model, training_set), training_set$Extent)
RMSE(predict(knn_model, test_set), test_set$Extent)
getModelInfo()
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set, method = "cforest")
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set, method = "cforest")
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set, method = "cforest")
# Make predictions on the test data
predictions <- knn_model %>% predict(test_set)
head(predictions)
# Compute the prediction error RMSE
RMSE(predict(knn_model, training_set), training_set$Extent)
RMSE(predict(knn_model, test_set), test_set$Extent)
print('hola')
# Compute the prediction error RMSE
print(paste0('RMSE of prediction in training dataset: ',RMSE(predict(knn_model, training_set), training_set$Extent)))
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set, method = "knn")
rf_model<- train(Extent ~ Trend + Year + Month, data = training_set, method = "cforest")
# Compute the prediction error RMSE
print(paste0('RMSE of prediction with knn model in training dataset: ',RMSE(predict(knn_model, training_set), training_set$Extent)))
print(paste0('RMSE of prediction with knn model in test dataset: ',RMSE(predict(knn_model, test_set), test_set$Extent)))
# Compute the prediction error RMSE
print(paste0('RMSE of prediction with random forest model in training dataset: ',RMSE(predict(rf_model, training_set), training_set$Extent)))
print(paste0('RMSE of prediction with random forest model in test dataset: ',RMSE(predict(rf_model, test_set), test_set$Extent)))
summary(modeling_df$Extent)
stddev(modeling_df$Extent)
stdev(modeling_df$Extent)
stddev(modeling_df$Extent)
sd(modeling_df$Extent)
summary(modeling_df$Extent)
sum(is.na(co2_data))
sum(is.na(ice_data))
print(paste0('number of missing values in the dataset: ',sum(is.na(co2_data))))
?train
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set, method = "knn", trControl=trainControl(method = "cv"))
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3))
# Compute the prediction error RMSE
print(paste0('RMSE of prediction with knn model in training dataset: ', RMSE(predict(knn_model, training_set), training_set$Extent)))
print(paste0('RMSE of prediction with knn model in test dataset: ', RMSE(predict(knn_model, test_set), test_set$Extent)))
linear_model<-lm(Extent ~ Trend + Year + as.factor(Month), data = joined_df)
summary(linear_model)
linear_model<-lm(Extent ~ Trend + Year + as.factor(Month), data = joined_df)
summary(linear_model)
linear_model<-lm(Extent ~ Trend + Year + (Month), data = joined_df)
linear_model<-lm(Extent ~ Trend + Year + as.factor(Month), data = joined_df)
summary(linear_model)
linear_model<-lm(Extent ~ Trend + Year + Month, data = joined_df)
summary(linear_model)
rf_model<- train(Extent ~ Trend + Year + as.factor(Month), data = training_set,
method = "cforest", trControl=trainControl(method = "cv", number=3))
# Compute the prediction error RMSE
print(paste0('RMSE of prediction with random forest model in training dataset: ', RMSE(predict(rf_model, training_set), training_set$Extent)))
print(paste0('RMSE of prediction with random forest model in test dataset: ', RMSE(predict(rf_model, test_set), test_set$Extent)))
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3), tuneLength=5)
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3), tuneLength=5)
rf_model<- train(Extent ~ Trend + Year + as.factor(Month), data = training_set,
method = "cforest", trControl=trainControl(method = "cv", number=3), tuneLength=5)
# Compute the prediction error RMSE
print(paste0('RMSE of prediction with knn model in training dataset: ', RMSE(predict(knn_model, training_set), training_set$Extent)))
print(paste0('RMSE of prediction with knn model in test dataset: ', RMSE(predict(knn_model, test_set), test_set$Extent)))
# Compute the prediction error RMSE
print(paste0('RMSE of prediction with random forest model in training dataset: ', RMSE(predict(rf_model, training_set), training_set$Extent)))
print(paste0('RMSE of prediction with random forest model in test dataset: ', RMSE(predict(rf_model, test_set), test_set$Extent)))
grid <- expand.grid(size=c(5,10,20,50), k=c(1,2,3,4,5))
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3), tuneGrid=grid)
getModelInfo()
knn_grid <- expand.grid(kmax=c(3,4,5,6,7), distance=c(5,10,15))
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3), tuneGrid=knn_grid)
knn_grid <- expand.grid(k=c(3,4,5,6,7), distance=c(5,10,15))
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3), tuneGrid=knn_grid)
knn_grid <- expand.grid(k=c(3,4,5,6,7), distance=c(5,10,15))
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3), tuneGrid=knn_grid)
knn_grid <- expand.grid(k=c(3,4,5,6,7), distance=c(5,10,15))
knn_grid <- expand.grid(k=c(3,4,5,6,7), distance=c(5,10,15))
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3), tuneGrid=knn_grid)
knn_grid <- expand.grid(k=c(3,4,5,6,7), distance=c(5,10,15))
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3), tuneGrid=knn_grid)
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3), tuneGrid=expand.grid(k = c(5, 11, 21, 25)))
knn_grid <- expand.grid(k=c(3,4,5,6,7))
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3), tuneGrid=knn_grid)
knn_model<- train(Extent ~ Trend + Year + Month, data = training_set,
method = "knn", trControl=trainControl(method = "cv", number=3), tuneGrid=knn_grid)
# Compute the prediction error RMSE
print(paste0('RMSE of prediction with knn model in training dataset: ', RMSE(predict(knn_model, training_set), training_set$Extent)))
print(paste0('RMSE of prediction with knn model in test dataset: ', RMSE(predict(knn_model, test_set), test_set$Extent)))
rf_grid <- expand.grid(mtry=c(1,2,3,4,5))
rf_model<- train(Extent ~ Trend + Year + as.factor(Month), data = training_set,
method = "cforest", trControl=trainControl(method = "cv", number=3), tuneGrid=rf_grid)
rf_model<- train(Extent ~ Trend + Year + as.factor(Month), data = training_set,
method = "cforest", trControl=trainControl(method = "cv", number=3), tuneGrid=rf_grid)
# Compute the prediction error RMSE
print(paste0('RMSE of prediction with random forest model in training dataset: ', RMSE(predict(rf_model, training_set), training_set$Extent)))
print(paste0('RMSE of prediction with random forest model in test dataset: ', RMSE(predict(rf_model, test_set), test_set$Extent)))
rf_grid <- expand.grid(mtry=c(3,6,9,12,15))
rf_model<- train(Extent ~ Trend + Year + as.factor(Month), data = training_set,
method = "cforest", trControl=trainControl(method = "cv", number=3), tuneGrid=rf_grid)
rf_model<- train(Extent ~ Trend + Year + as.factor(Month), data = training_set,
method = "ctree2", trControl=trainControl(method = "cv", number=3))
# Compute the prediction error RMSE
print(paste0('RMSE of prediction with random forest model in training dataset: ', RMSE(predict(rf_model, training_set), training_set$Extent)))
print(paste0('RMSE of prediction with random forest model in test dataset: ', RMSE(predict(rf_model, test_set), test_set$Extent)))
rf_model$modelInfo
rf_model<- train(Extent ~ Trend + Year + as.factor(Month), data = training_set,
method = "cforest", trControl=trainControl(method = "cv", number=3), tuneGrid=rf_grid)
# Compute the prediction error RMSE
print(paste0('RMSE of prediction with random forest model in training dataset: ', RMSE(predict(rf_model, training_set), training_set$Extent)))
print(paste0('RMSE of prediction with random forest model in test dataset: ', RMSE(predict(rf_model, test_set), test_set$Extent)))
ggplot()+
geom_line(lm)
ggplot(modeling_df,aes(Trend, Extent)) +
geom_smooth(method='lm', formula= Extent ~ Trend + Year + Month)
ggplot(modeling_df,aes(modeling_df$Trend, modeling_df$Extent)) +
geom_smooth(method='lm', formula= Extent ~ Trend + Year + Month)
ggplot(modeling_df,aes(modeling_df$Trend, modeling_df$Extent)) +
geom_smooth(method='lm', formula= Extent ~ Trend + Year + Month, data = modeling_df)
